<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>HTML5 test</title>
		<meta name="description" content="" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
	</head>
	<body>
		<p>Determining if an IPv4 address is within a CIDR range in JavaScript</p>
        <script>
			// https://tech.mybuilder.com/determining-if-an-ipv4-address-is-within-a-cidr-range-in-javascript/
			var ip4ToInt = function(ip) {
				var reducer = function(int, oct) {
					return (int << 8) + parseInt(oct, 10);
				};
				return ip.split('.').reduce(reducer, 0) >>> 0;
			}
			var isIp4InCidr = function(ip) {
				return function(cidr) {
					var [range, bits = 32] = cidr.split('/');
					var mask = ~(2 ** (32 - bits) - 1);
					return (ip4ToInt(ip) & mask) === (ip4ToInt(range) & mask); 
				}
			}
			var isIp4InCidrs = function(ip, cidrs) {
				return cidrs.some(isIp4InCidr(ip));
			}
			
			var cidrs = ['164.3.0.0/16', '185.46.212.0/23', '165.225.240.0/23', '165.225.88.0/23', '165.225.12.0/23', '196.23.154.96/27', '165.225.64.0/24', '165.225.194.0/23', '147.161.160.0/23', '165.225.72.0/22', '165.225.26.0/23 ', '147.161.164.0/23', '197.98.201.0/24', '147.161.162.0/23', '197.156.241.224/27', '154.113.23.0/24', '165.225.80.0/22', '165.225.16.0/23', '147.161.166.0/23', '165.225.92.0/23', '165.225.196.0/23', '165.225.198.0/23', '165.225.86.0/23', '165.225.202.0/23', '165.225.66.0/24', '165.225.90.0/23', '147.161.168.0/23', '147.161.170.0/23', '213.52.102.0/24', '165.225.76.0/23', '165.225.20.0/23', '165.225.204.0/23', '165.225.192.0/23', '94.188.131.0/25', '165.225.200.0/23', '165.225.84.0/23', '165.225.206.0/23', '185.46.214.0/23', '165.225.94.0/23', '104.129.206.0/23', '165.225.0.0/23', '165.225.56.0/22', '165.225.34.0/23', '165.225.216.0/23', '104.129.200.0/24', '165.225.10.0/23', '104.129.198.0/23', '165.225.32.0/23', '165.225.222.0/23', '165.225.212.0/23', '165.225.38.0/23', '165.225.220.0/23', '165.225.218.0/23', '104.129.202.0/23', '165.225.242.0/23', '64.215.22.0/24', '165.225.214.0/23', '147.161.128.0/23', '165.225.50.0/23', '165.225.36.0/23', '165.225.208.0/23', '165.225.210.0/23', '104.129.194.0/23', '165.225.8.0/23 ', '124.248.141.0/24', '211.144.19.0/24', '165.225.104.0/24', '165.225.122.0/23', '165.225.116.0/23', '165.225.234.0/23', '165.225.98.0/24', '165.225.226.0/23', '165.225.106.0/23', '165.225.120.0/23', '165.225.124.0/23', '147.161.192.0/23', '165.225.228.0/23', '1.234.57.0/24', '58.220.95.0/24', '165.225.112.0/23', '165.225.230.0/23', '175.45.116.0/24', '165.225.114.0/23', '165.225.232.0/23', '165.225.102.0/24', '221.122.91.0/24', '165.225.110.0/23', '165.225.96.0/23'];

			console.log(isIp4InCidrs('192.168.103.255', cidrs));
			console.log(isIp4InCidrs('175.45.116.0', cidrs));
		</script>
	</body>
</html>
