<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>iFrame Content</title>
        <style>
            body {
                margin: 0;
                padding: 0;
            }

            body h2 {
                margin-top: 0;
            }
        </style>
	</head>
	<body>
		<div id="my-content">
            <h2>Hello World! I'm inside an iframe!</h2>
            <p><button onclick="addMoreText()">Add more text...</button></p>
            <p>Is hendrerit ad quia iuvenis, homine quaestionis tibi confluentiam Scelerata. Ait Cumque materia eam sed esse haec puella est amet coram me. Caelum pariter in deinde plectrum anni ipsa mihi. Domus suo Nescimus de memor nostris qui enim formam se vero rex ut casus tui Dianae autem est cum. Tua Care die ad per animum est in rei sensibilium. Iussit hoc contra te sed esse more defuncta ait mea Stet.</p>
        </div>
        <p>The End</p>

		<script>
            // to help with testing 
            function addMoreText() {
                const contentElm = document.getElementById('my-content');
                const p = document.createElement('p');
                p.innerHTML = 'Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.';
                contentElm.appendChild(p);
            }

            function setOberver() {
                const resizeObserver = new ResizeObserver((entries) => {
                    for (let entry of entries) {
                        if(entry.contentBoxSize) {
                            // Firefox implements `contentBoxSize` as a single content rect, rather than an array
                            const contentBoxSize = Array.isArray(entry.contentBoxSize) ? entry.contentBoxSize[0] : entry.contentBoxSize;
                            //console.log(contentBoxSize);
                        } else {
                            //console.log(entry.contentRect.width );
                        }
                    }

                    console.log('Size changed');
                    sendHeight();
                });

                resizeObserver.observe(document.body);
            }
            
           function sendHeight() {
                const html = document.documentElement;
                const height = document.body.scrollHeight;
                
                // if page is inside iframe
                if (window.self !== window.top) {
                    window.parent.postMessage(height, '*');
                }
            }

            setOberver();
		</script>
	</body>
</html>
